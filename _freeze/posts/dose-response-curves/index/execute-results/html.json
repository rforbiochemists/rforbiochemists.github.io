{
  "hash": "6f0d0ad63e68a058de41a228e6c48f0a",
  "result": {
    "markdown": "---\ntitle: \"Calculating a $V_{max}$ and $K_{m}$ for an Enzyme\"\nsubtitle: \"How tightly does my protein bind?\"\ntags: [data vis, ggplot2, R, lm, standard curve, tutorial]\ndate: today\nauthor: Brady Johnston\neditor: visual\ntoc: true\nnumber-sections: true\nimage: enzymeplot.png\ntoc-location: right\ncode-fold: false\ncode-link: true\ncode-line-numbers: true  \n---\n\nPlaying around with modelling dose-response curves in R, to calculate a $K_{d}$ for an interaction between a protein and it's potential binding target.\nFrom this we can compare the rates of two enzymes, and see if our mutation had any effect.\nTher results of which can be seen below in @tbl-plot-coefficients.[^1]\n\n[^1]: This isn't actually the best way to go about it.\n    There are far too many details, which are more useful if you are doing more advance modelling, but we are just after an estimate of the $K_{m}$ and the $V_{max}$ from our data.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(biochemr)\nmod <- Puromycin %>% \n  bio_enzyme_rate(conc, rate, group = state)\n\npurrr::map(mod$model, broom::glance)\n```\n\n::: {.cell-output-stdout}\n```\n[[1]]\n# A tibble: 1 x 4\n    AIC   BIC logLik    df.residual\n  <dbl> <dbl> <logLik>        <int>\n1  95.3  96.7 -44.63548          10\n\n[[2]]\n# A tibble: 1 x 4\n    AIC   BIC logLik   df.residual\n  <dbl> <dbl> <logLik>       <int>\n1  85.2  86.4 -39.5805           9\n```\n:::\n:::\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\nmod %>% \n  bio_plot(colour = state, facet = FALSE) + \n  ggplot2::coord_cartesian(ylim = c(0, NA))\n```\n\n::: {.cell-output-display}\n![The enzyme responses plotted using `bio_plot()` function.](index_files/figure-html/fig-first-plot-1.png){#fig-first-plot width=672}\n:::\n:::\n\n::: {#tbl-plot-coefficients .cell tbl-cap='The resulting coefficients from the model.'}\n\n```{.r .cell-code}\nmod %>% \n  bio_coefs() %>% \n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|state     |term |    estimate| std.error| statistic|   p.value|\n|:---------|:----|-----------:|---------:|---------:|---------:|\n|treated   |Vmax | 212.6838544| 7.1606488| 29.701757| 0.0000000|\n|treated   |Km   |   0.0641215| 0.0087112|  7.360806| 0.0000242|\n|untreated |Vmax | 160.2802158| 6.8060674| 23.549607| 0.0000000|\n|untreated |Km   |   0.0477084| 0.0084203|  5.665846| 0.0003073|\n:::\n:::\n\nIs there actually a difference between the two sates?\nWe can see their fits inside of @fig-first-plot but we are unsure if it will actually be significant.\nWe can compare the two models:\n\n::: {.cell}\n\n```{.r .cell-code}\ncomp <- purrr::reduce(mod$model, anova) %>% \n  tibble::as_tibble() %>% \n  dplyr::mutate(model = as.character(mod$state))\n```\n\n::: {.cell-output-stdout}\n```\n\n1st model\n fct:      .model\n2nd model\n fct:      .model\n```\n:::\n\n```{.r .cell-code}\ncomp\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 2 x 6\n  ModelDf   RSS    Df `F value` `p value` model    \n    <int> <dbl> <int>     <dbl>     <dbl> <chr>    \n1      10 1195.    NA     NA      NA      treated  \n2       9  860.     1      3.52    0.0935 untreated\n```\n:::\n:::\n\nBy the looks of things, we probably couldn't say that there was actually a real difference between the two states, with a p-value of only 0.094 .\n\n## What about with a different data set?\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmod <- DNase %>% \n  tibble::as_tibble() %>% \n  bio_binding(conc, density, Run)\n\n \nbio_plot(mod,colour = Run) + \n  ggplot2::theme_classic()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nmod %>% \n  bio_coefs() %>% \n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|Run |term |   estimate| std.error|   statistic|   p.value|\n|:---|:----|----------:|---------:|-----------:|---------:|\n|1   |min  |  2.2705194| 0.0364655|  62.2649303| 0.0000000|\n|1   |max  |  0.0073850| 0.0100745|   0.7330375| 0.4765466|\n|1   |kd   |  4.1084971| 0.1851084|  22.1950839| 0.0000000|\n|2   |min  |  2.6128488| 0.0292937|  89.1950485| 0.0000000|\n|2   |max  |  0.0128038| 0.0074880|   1.7098975| 0.1110294|\n|2   |kd   |  4.4508310| 0.1352866|  32.8992656| 0.0000000|\n|3   |min  |  2.6775958| 0.0840040|  31.8746404| 0.0000000|\n|3   |max  |  0.0578853| 0.0195722|   2.9575268| 0.0111100|\n|3   |kd   |  4.8176998| 0.4042475|  11.9176993| 0.0000000|\n|4   |min  |  2.3309391| 0.0262891|  88.6655629| 0.0000000|\n|4   |max  | -0.0013376| 0.0071064|  -0.1882271| 0.8536051|\n|4   |kd   |  4.2111290| 0.1311680|  32.1048592| 0.0000000|\n|5   |min  |  2.2807621| 0.0218934| 104.1757485| 0.0000000|\n|5   |max  |  0.0112117| 0.0065355|   1.7154931| 0.1099752|\n|5   |kd   |  3.8414222| 0.1062143|  36.1667237| 0.0000000|\n|6   |min  |  2.3621820| 0.0283166|  83.4204860| 0.0000000|\n|6   |max  |  0.0763727| 0.0076901|   9.9313315| 0.0000002|\n|6   |kd   |  4.1940893| 0.1437941|  29.1673187| 0.0000000|\n|7   |min  |  2.2894235| 0.0229600|  99.7137792| 0.0000000|\n|7   |max  |  0.0783058| 0.0063524|  12.3270339| 0.0000000|\n|7   |kd   |  4.1031800| 0.1192003|  34.4225514| 0.0000000|\n|8   |min  |  2.2981260| 0.0396233|  57.9993070| 0.0000000|\n|8   |max  |  0.0290558| 0.0112390|   2.5852649| 0.0226296|\n|8   |kd   |  4.0422784| 0.1979815|  20.4174545| 0.0000000|\n|9   |min  |  2.2054284| 0.0349925|  63.0258299| 0.0000000|\n|9   |max  |  0.0230895| 0.0109794|   2.1029957| 0.0555099|\n|9   |kd   |  3.6510849| 0.1715205|  21.2865860| 0.0000000|\n|10  |min  |  2.1503869| 0.0339103|  63.4139688| 0.0000000|\n|10  |max  |  0.0489323| 0.0111212|   4.3999208| 0.0007178|\n|10  |kd   |  3.4850652| 0.1681737|  20.7230059| 0.0000000|\n|11  |min  |  2.2333839| 0.0360498|  61.9527653| 0.0000000|\n|11  |max  |  0.0438119| 0.0105591|   4.1492156| 0.0011429|\n|11  |kd   |  3.8771385| 0.1830020|  21.1863136| 0.0000000|\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": [],
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}